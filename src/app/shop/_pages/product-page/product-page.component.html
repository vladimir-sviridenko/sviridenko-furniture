<div class='product-page' *ngIf='!(this.shopFacadeService.isShopLoading$ | async)'>
  <ng-container *ngIf='this.shopFacadeService.currentProduct$ | async'>
    <div class='product-page__back-button-top'>
      <ng-template *ngTemplateOutlet='backButton'></ng-template>
    </div>
    <div class="product-page__image-container">
      <mat-card class="product-page__image">
        <app-lazy-image [title]='product.name' [src]='photoUrl.high'></app-lazy-image>
      </mat-card>
      <button mat-stroked-button class='product-page__button product-page__button_update-photo' 
      *ngIf='photoUrl !== product.photoUrl'>Показать фото продукта</button>
      <div class='product-page__back-button-bottom'>
        <ng-template *ngTemplateOutlet='backButton'></ng-template>
      </div>
    </div>
    <mat-card  class='product-page__options-card'>
      <app-product-options
      *ngIf='product.options.length > 0' 
      [options]='product.options'></app-product-options>
    </mat-card>
    <mat-card class="product-page__total-card">
      <mat-card-title class="product-page__name">{{product.name}}</mat-card-title>
      <mat-card-content>
        <table class="product-page__table">
          <ng-container *ngIf='product.size'>
            <tr>
              <td>Высота:</td>
              <td>{{product.size.height}} см</td>
            </tr>
            <tr>
              <td>Ширина:</td>
              <td>{{product.size.width}} см</td>
            </tr>
            <tr>
              <td>Глубина:</td>
              <td>{{product.size.depth}} см</td>
            </tr>
          </ng-container>
          <tr *ngFor='let option of product.options'>
            <td>{{option.type}}: </td>
            <td>{{null}}</td>
          </tr>
        </table>
      </mat-card-content>
      <mat-card-title class="product-page__price">Итого: {{product.price | currency:'RUB':'code':'4.0':'ru'}}</mat-card-title>
      <mat-card-actions class="product-page__actions">
        <button mat-flat-button  class="product-page__button"  *ngIf='product.price' color='primary'>В корзину</button>
      </mat-card-actions>
    </mat-card>
  </ng-container>
</div>

<ng-template #backButton>
  <button mat-stroked-button class='product-page__button product-page__button_back'
      [routerLink]='["/shop", (this.shopFacadeService.currentAlbum$ | async).id ]'>
      <span>Показать ещё {{(this.shopFacadeService.currentAlbum$ | async).title | lowercase}}</span>
    </button>
</ng-template>